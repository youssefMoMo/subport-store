<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SubPort | Digital Store</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --main-bg: #151816;       
            --element-color: #77caea;  
            --card-bg: #1e211f;       
            --text-main: #ffffff;
            --text-secondary: #cccccc;
            --status-green: #00ff88; 
            --status-red: #ff4444;
            --status-blue: #2196f3;
            --border-radius: 16px;
            --transition-speed: 0.3s;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--main-bg);
            color: var(--text-main);
            margin: 0; padding: 0;
            min-height: 100vh;
            display: flex; flex-direction: column; align-items: center;
            transition: all var(--transition-speed) ease;
            padding-bottom: 40px;
        }

        /* --- Header --- */
        header {
            width: 100%; max-width: 800px; padding: 20px;
            display: flex; justify-content: space-between; align-items: center;
            position: relative; z-index: 100; margin-bottom: 10px;
        }
        .brand-area h1 { color: var(--element-color); font-weight: 900; font-size: clamp(22px, 5vw, 28px); letter-spacing: 2px; text-transform: uppercase; margin: 0; }
        .brand-area .subtitle { color: var(--text-secondary); font-size: 12px; margin-top: 4px; opacity: 0.8; }

        /* --- Language Switcher --- */
        .lang-wrapper { position: relative; }
        .lang-btn {
            background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(119, 202, 234, 0.3);
            color: var(--element-color); padding: 8px 12px; border-radius: 12px;
            cursor: pointer; display: flex; align-items: center; gap: 8px; font-weight: bold; font-size: 14px;
        }
        .lang-menu {
            position: absolute; top: 45px; right: 0; background: var(--card-bg);
            border: 1px solid #333; border-radius: 12px; width: 140px; display: none;
            flex-direction: column; overflow: hidden; box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            opacity: 0; transform: translateY(-10px); transition: 0.3s; z-index: 200;
        }
        .lang-menu.active { display: flex; }
        .lang-menu.show-anim { opacity: 1; transform: translateY(0); }
        .lang-option { padding: 12px 15px; cursor: pointer; display: flex; align-items: center; gap: 10px; color: var(--text-secondary); transition: 0.2s; }
        .lang-option:hover { background: rgba(119, 202, 234, 0.1); color: var(--element-color); }

        /* --- Main Content --- */
        .main-wrapper { width: 100%; max-width: 550px; padding: 0 20px; animation: fadeInUp 0.8s ease-out forwards; }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        .container {
            background-color: var(--card-bg); padding: 30px; border-radius: var(--border-radius);
            border: 1px solid rgba(119, 202, 234, 0.2); box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);
            margin-bottom: 30px; position: relative; margin-top: 10px;
        }

        /* --- Inputs Styling & Logic --- */
        .form-group { margin-bottom: 25px; position: relative; }
        label { display: flex; justify-content: space-between; margin-bottom: 8px; font-weight: 600; font-size: 14px; color: var(--text-secondary); }
        
        .status-text { font-size: 11px; font-weight: normal; opacity: 0; transition: 0.3s; }
        .status-text.checking { color: var(--status-blue); opacity: 1; }
        .status-text.success { color: var(--status-green); opacity: 1; }
        .status-text.error { color: var(--status-red); opacity: 1; }

        .input-wrapper { position: relative; width: 100%; }

        input, select {
            width: 100%; padding: 14px; background: rgba(0,0,0,0.2);
            border: 1px solid #333; border-radius: 12px; color: var(--text-main);
            font-size: 16px; transition: 0.3s; appearance: none;
        }
        
        .input-with-image input { padding-inline-end: 55px; }

        .avatar-preview {
            position: absolute; top: 50%; transform: translateY(-50%) scale(0);
            width: 38px; height: 38px; border-radius: 50%; object-fit: cover;
            border: 2px solid #333; transition: 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            pointer-events: none; z-index: 5;
        }
        
        html[dir="ltr"] .avatar-preview { right: 10px; }
        html[dir="rtl"] .avatar-preview { left: 10px; }

        .input-wrapper.loading input { border-color: var(--status-blue); }
        .input-wrapper.success input { border-color: var(--status-green); box-shadow: 0 0 15px rgba(0, 255, 136, 0.15); }
        .input-wrapper.error input { border-color: var(--status-red); animation: shake 0.3s; }

        .input-wrapper.success .avatar-preview { transform: translateY(-50%) scale(1); border-color: var(--status-green); }

        @keyframes shake { 0% {transform: translateX(0);} 25% {transform: translateX(5px);} 50% {transform: translateX(-5px);} 75% {transform: translateX(5px);} 100% {transform: translateX(0);} }

        /* --- Price Section --- */
        .result-box { background: rgba(119, 202, 234, 0.03); padding: 20px; border-radius: 12px; margin: 25px 0; text-align: center; border: 1px dashed rgba(119, 202, 234, 0.4); }
        .bill-details { display: none; margin-bottom: 15px; font-size: 14px; color: var(--text-secondary); background: rgba(0,0,0,0.2); padding: 10px; border-radius: 8px; }
        .bill-row { display: flex; justify-content: space-between; margin-bottom: 6px; }
        .price-display { font-size: 36px; font-weight: 800; color: var(--element-color); text-shadow: 0 0 20px rgba(119, 202, 234, 0.2); }

        /* --- Buttons --- */
        button.main-btn {
            width: 100%; padding: 16px; background-color: var(--element-color); color: #000000;
            border: none; border-radius: 12px; font-size: 18px; font-weight: bold; cursor: pointer;
            transition: 0.3s; display: flex; justify-content: center; align-items: center;
        }
        button.main-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(119, 202, 234, 0.3); }
        button.main-btn:disabled { background-color: #333; color: #666; cursor: not-allowed; box-shadow: none; transform: none; }

        /* --- Status Badge --- */
        .status-badge {
            position: absolute; top: 25px; background: rgba(255, 255, 255, 0.07);
            border: 1px solid rgba(255, 255, 255, 0.1); color: var(--text-main);
            padding: 6px 12px; border-radius: 20px; font-weight: 600; font-size: 11px;
            display: flex; align-items: center; gap: 6px; z-index: 10; backdrop-filter: blur(5px);
        }
        html[dir="ltr"] .status-badge { right: 25px; left: auto; }
        html[dir="rtl"] .status-badge { left: 25px; right: auto; }
        .status-dot { width: 8px; height: 8px; border-radius: 50%; background-color: var(--status-red); display: inline-block; }
        .status-dot.available { background-color: var(--status-green); box-shadow: 0 0 8px var(--status-green); animation: pulse 2s infinite; }
        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(0, 255, 136, 0.7); } 70% { box-shadow: 0 0 0 6px rgba(0, 255, 136, 0); } 100% { box-shadow: 0 0 0 0 rgba(0, 255, 136, 0); } }

        select { background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%2377caea' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e"); background-repeat: no-repeat; background-position: right 1rem center; background-size: 1em; }
        html[dir="rtl"] select { background-position: left 1rem center; }

        .future-services { margin-top: 30px; }
        .grid-title { text-align: center; color: var(--text-secondary); margin-bottom: 20px; font-size: 14px; position: relative; }
        .grid-title::after { content: ''; display: block; width: 40px; height: 2px; background: var(--element-color); margin: 10px auto 0; opacity: 0.5; }
        .services-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 15px; }
        .service-card { background: var(--card-bg); border: 1px solid #333; padding: 20px; border-radius: 12px; text-align: center; opacity: 0.5; transition: 0.3s; cursor: not-allowed; user-select: none; }
        .service-card:hover { opacity: 0.7; border-color: #555; }
        .service-icon { font-size: 26px; color: var(--element-color); margin-bottom: 10px; }
        .service-name { font-weight: 600; font-size: 13px; margin-bottom: 5px; }
        .coming-soon { font-size: 10px; background: #333; padding: 4px 8px; border-radius: 10px; color: #aaa; }

        /* Dashboard (Hidden by default) */
        .order-dashboard { display: none; text-align: center; }
        .order-header { margin-bottom: 20px; border-bottom: 1px solid #333; padding-bottom: 15px; }
        .status-pill { display: inline-block; padding: 8px 20px; border-radius: 50px; font-weight: bold; font-size: 14px; margin: 15px 0; color: white; background: var(--status-blue); box-shadow: 0 0 15px rgba(33, 150, 243, 0.4); }
        .order-data-row { display: flex; justify-content: space-between; margin-bottom: 10px; padding: 10px; background: rgba(255,255,255,0.05); border-radius: 8px; font-size: 14px; }
    </style>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
</head>
<body>

    <header>
        <div class="brand-area">
            <h1>SubPort</h1>
            <div class="subtitle" data-key="subtitle">Your Digital Gateway</div>
        </div>
        <div class="lang-wrapper">
            <button class="lang-btn" onclick="toggleLangMenu()">
                <i class="fa-solid fa-globe"></i> <span id="currentLangLabel">English</span> <i class="fa-solid fa-chevron-down" style="font-size: 10px;"></i>
            </button>
            <div class="lang-menu" id="langMenu">
                <div class="lang-option" onclick="switchLang('en')"><span>ğŸ‡ºğŸ‡¸</span> English</div>
                <div class="lang-option" onclick="switchLang('ar')"><span>ğŸ‡ªğŸ‡¬</span> Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</div>
            </div>
        </div>
    </header>

    <div class="main-wrapper" id="mainContent">
        <div class="container">
            
            <div id="orderInputSection">
                <div class="status-badge">
                    <span class="status-dot" id="statusDot"></span>
                    <span id="statusText">Checking...</span>
                </div>
                
                <div class="section-title"><i class="fa-regular fa-gem"></i> <span data-key="service_robux">Robux Top-up</span></div>
                
                <div class="form-group">
                    <label data-key="label_location">Location</label>
                    <select id="location" onchange="calculatePrice()">
                        <option value="egypt" data-key="opt_egypt">Egypt (EGP - Vodafone Cash)</option>
                        <option value="global" data-key="opt_global">Global (USD - PayPal)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label data-key="label_amount">Required Amount</label>
                    <input type="number" id="robuxAmount" placeholder="e.g., 1000" oninput="calculatePrice()">
                </div>

                <div class="result-box">
                    <div id="billDetails" class="bill-details">
                        <div class="bill-row"><span data-key="row_subtotal">Base Price</span><span id="subtotalVal">0.00 $</span></div>
                        <div class="bill-row" style="color: var(--status-red); font-size: 12px;"><span data-key="row_fees">PayPal Fees</span><span id="feesVal">+ 0.00 $</span></div>
                    </div>
                    <div class="total-label" data-key="label_total">Total Price</div>
                    <div class="price-display" id="finalPrice">0 EGP</div>
                </div>

                <hr style="border-color: #333; margin: 25px 0; opacity: 0.5;">

                <form id="orderForm" onsubmit="submitOrder(event)">
                    
                    <div class="form-group input-with-image">
                        <label>
                            <span data-key="label_discord">Discord Username</span>
                            <span class="status-text" id="discordStatus"></span>
                        </label>
                        <div class="input-wrapper" id="discordWrapper">
                            <input type="text" id="discordName" required placeholder="username#1234" onkeyup="validateInput('discord')">
                            <img src="" id="discordAvatar" class="avatar-preview">
                        </div>
                    </div>

                    <div class="form-group input-with-image">
                        <label>
                            <span data-key="label_roblox">Roblox Username</span>
                            <span class="status-text" id="robloxStatus"></span>
                        </label>
                        <div class="input-wrapper" id="robloxWrapper">
                            <input type="text" id="robloxName" required placeholder="Roblox User" onkeyup="validateInput('roblox')">
                            <img src="" id="robloxAvatar" class="avatar-preview">
                        </div>
                    </div>

                    <button type="submit" class="main-btn" id="submitBtn" data-key="btn_confirm" disabled>Confirm & Order</button>
                </form>
            </div>

            <div id="orderStatusSection" class="order-dashboard">
                <div class="order-header">
                    <h2 style="margin: 0; color: white;" data-key="status_title">Order Sent!</h2>
                    <div style="font-size: 14px; color: #aaa;" id="displayOrderId">#ORDER-0000</div>
                </div>
                <div class="status-pill" data-key="status_pending">Pending Approval</div>
                <div class="order-data-row"><span data-key="label_discord">Discord</span><span id="displayDiscord" style="color: var(--element-color);"></span></div>
                <div class="order-data-row"><span data-key="label_roblox">Roblox</span><span id="displayRoblox" style="color: var(--element-color);"></span></div>
                <div class="order-data-row"><span data-key="label_total">Total Price</span><span id="displayPrice" style="font-weight: bold;"></span></div>
                <p style="font-size: 12px; color: #666; margin-top: 20px;" data-key="email_sent_note">Check your email.</p>
                <button class="main-btn" onclick="location.reload()" style="margin-top: 15px; background: #333;">New Order</button>
            </div>

        </div>

        <div class="future-services">
            <div class="grid-title" data-key="title_coming_soon">Services Coming Soon</div>
            <div class="services-grid">
                <div class="service-card"><div class="service-icon"><i class="fa-brands fa-steam"></i></div><div class="service-name" data-key="srv_steam">Steam Games</div><span class="coming-soon" data-key="badge_soon">Coming Soon</span></div>
                <div class="service-card"><div class="service-icon"><i class="fa-brands fa-discord"></i></div><div class="service-name" data-key="srv_discord">Discord Services</div><span class="coming-soon" data-key="badge_soon">Coming Soon</span></div>
                <div class="service-card"><div class="service-icon"><i class="fa-solid fa-robot"></i></div><div class="service-name" data-key="srv_ai">AI Subscriptions</div><span class="coming-soon" data-key="badge_soon">Coming Soon</span></div>
            </div>
        </div>
    </div>

    <script>
        // ================= SETTINGS =================
        const isRobuxAvailable = true; 
        const EGP_PER_1000 = 250;
        const USD_PER_1000 = 5.4;
        // ============================================

        const translations = {
            en: {
                subtitle: "Your Digital Gateway",
                available_now: "Available Now",
                out_of_stock: "Out of Stock",
                service_robux: "Robux Top-up",
                label_location: "Location",
                opt_egypt: "Egypt (EGP - Vodafone Cash)",
                opt_global: "Global (USD - PayPal)",
                label_amount: "Required Amount",
                label_total: "Total Price",
                row_subtotal: "Base Price",
                row_fees: "PayPal Fees",
                label_discord: "Discord Username",
                label_roblox: "Roblox Username",
                btn_confirm: "Confirm & Order",
                title_coming_soon: "Services Coming Soon",
                srv_steam: "Steam Games",
                srv_discord: "Discord Services",
                srv_ai: "AI Subscriptions",
                badge_soon: "Coming Soon",
                ph_amount: "e.g., 1000",
                alert_stock: "Sorry, Robux is currently out of stock!",
                status_title: "Order Sent!",
                status_pending: "Pending Approval",
                email_sent_note: "Check your email for details.",
                
                txt_checking: "Checking...",
                txt_verified: "Verified",
                txt_error: "Not Found / Not In Group"
            },
            ar: {
                subtitle: "Ø¨ÙˆØ§Ø¨ØªÙƒ Ø§Ù„Ø±Ù‚Ù…ÙŠØ© Ø§Ù„Ø£Ø³Ø±Ø¹",
                available_now: "Ù…ØªÙˆÙØ± Ø§Ù„Ø¢Ù†",
                out_of_stock: "ØºÙŠØ± Ù…ØªÙˆÙØ±",
                service_robux: "Ø´Ø­Ù† Ø±ÙˆØ¨ÙƒØ³ (Robux)",
                label_location: "Ø§Ù„Ø¯ÙˆÙ„Ø© / Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹",
                opt_egypt: "Ù…ØµØ± (Ø¬Ù†ÙŠÙ‡ - ÙÙˆØ¯Ø§ÙÙˆÙ† ÙƒØ§Ø´)",
                opt_global: "Ø®Ø§Ø±Ø¬ Ù…ØµØ± (Ø¯ÙˆÙ„Ø§Ø± - PayPal)",
                label_amount: "Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©",
                label_total: "Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø·Ù„ÙˆØ¨",
                row_subtotal: "Ø³Ø¹Ø± Ø§Ù„Ø±ÙˆØ¨ÙƒØ³ Ø§Ù„Ø£ØµÙ„ÙŠ",
                row_fees: "Ø¶Ø±ÙŠØ¨Ø© Ø¨Ø§ÙŠ Ø¨Ø§Ù„",
                label_discord: "Ø§Ø³Ù… Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯",
                label_roblox: "Ø§Ø³Ù… Ø±ÙˆØ¨Ù„ÙˆÙƒØ³",
                btn_confirm: "ØªØ£ÙƒÙŠØ¯ ÙˆØ­Ø¬Ø² Ø§Ù„Ø·Ù„Ø¨",
                title_coming_soon: "Ø®Ø¯Ù…Ø§Øª Ù‚Ø§Ø¯Ù…Ø© ÙÙŠ SubPort",
                srv_steam: "Ø£Ù„Ø¹Ø§Ø¨ Steam",
                srv_discord: "Ø®Ø¯Ù…Ø§Øª Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯",
                srv_ai: "Ø§Ø´ØªØ±Ø§ÙƒØ§Øª AI",
                badge_soon: "Ù‚Ø±ÙŠØ¨Ø§Ù‹",
                ph_amount: "Ù…Ø«Ù„Ø§Ù‹: 1000",
                alert_stock: "Ø¹Ø°Ø±Ø§Ù‹ØŒ Ø§Ù„Ø±ÙˆØ¨ÙƒØ³ ØºÙŠØ± Ù…ØªÙˆÙØ± Ø­Ø§Ù„ÙŠØ§Ù‹!",
                status_title: "ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨!",
                status_pending: "ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©",
                email_sent_note: "ØªÙ… Ø¥Ø±Ø³Ø§Ù„ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨ Ø¥Ù„Ù‰ Ø¥ÙŠÙ…ÙŠÙ„Ùƒ.",

                txt_checking: "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚...",
                txt_verified: "Ù…ÙˆØ«Ù‚",
                txt_error: "ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø§Ù„Ø¬Ø±ÙˆØ¨"
            }
        };

        let currentLang = 'en';
        let validFields = { discord: false, roblox: false };
        let typingTimer;

        // --- REAL API VALIDATION ---
        async function validateInput(type) {
            const input = document.getElementById(`${type}Name`);
            const wrapper = document.getElementById(`${type}Wrapper`);
            const statusTxt = document.getElementById(`${type}Status`);
            const avatar = document.getElementById(`${type}Avatar`);
            const btn = document.getElementById('submitBtn');
            const txt = translations[currentLang];

            // 1. Loading State
            wrapper.className = 'input-wrapper loading';
            statusTxt.innerText = txt.txt_checking;
            statusTxt.className = 'status-text checking';
            validFields[type] = false;
            btn.disabled = true;
            
            clearTimeout(typingTimer);

            if(input.value.length < 3) {
                wrapper.className = 'input-wrapper';
                statusTxt.innerText = "";
                return;
            }

            // 2. Wait and Fetch API
            typingTimer = setTimeout(async () => {
                try {
                    // Call the API endpoint
                    const response = await fetch(`/api/${type}?username=${input.value}`);
                    const data = await response.json();

                    if (data.valid) {
                        // For Roblox: Check Group Membership
                        if (type === 'roblox' && !data.isMember) {
                            wrapper.className = 'input-wrapper error';
                            statusTxt.innerText = currentLang === 'en' ? "Not in Group" : "ØºÙŠØ± Ù…Ù†Ø¶Ù… Ù„Ù„Ø¬Ø±ÙˆØ¨";
                            statusTxt.className = 'status-text error';
                            validFields[type] = false;
                            avatar.src = "";
                        } else {
                            // Success
                            wrapper.className = 'input-wrapper success';
                            statusTxt.innerText = txt.txt_verified;
                            statusTxt.className = 'status-text success';
                            validFields[type] = true;
                            avatar.src = data.avatar;
                        }
                    } else {
                        // User Not Found
                        wrapper.className = 'input-wrapper error';
                        statusTxt.innerText = txt.txt_error;
                        statusTxt.className = 'status-text error';
                        validFields[type] = false;
                        avatar.src = "";
                    }
                } catch (error) {
                    console.error(error);
                    wrapper.className = 'input-wrapper error';
                    statusTxt.innerText = "Connection Error";
                }
                checkAllValid();
            }, 1000); 
        }

        function checkAllValid() {
            const btn = document.getElementById('submitBtn');
            const amount = document.getElementById('robuxAmount').value;
            if(validFields.discord && validFields.roblox && amount > 0 && isRobuxAvailable) {
                btn.disabled = false;
            } else {
                btn.disabled = true;
            }
        }

        // --- Standard Logic ---
        function updateStockStatus() {
            const dot = document.getElementById('statusDot');
            const text = document.getElementById('statusText');
            const txtData = translations[currentLang];
            if(isRobuxAvailable) {
                dot.classList.add('available');
                text.innerText = txtData.available_now;
            } else {
                dot.classList.remove('available');
                text.innerText = txtData.out_of_stock;
            }
        }

        function toggleLangMenu() {
            const menu = document.getElementById('langMenu');
            menu.style.display = (menu.style.display === 'flex') ? 'none' : 'flex';
            if(menu.style.display === 'flex') setTimeout(() => menu.classList.add('show-anim'), 10);
            else menu.classList.remove('show-anim');
        }

        function switchLang(lang) {
            if(lang === currentLang) return;
            const wrapper = document.getElementById('mainContent');
            wrapper.classList.add('fading');
            document.getElementById('langMenu').style.display = 'none';
            setTimeout(() => {
                currentLang = lang;
                document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
                document.getElementById('currentLangLabel').innerText = lang === 'en' ? 'English' : 'Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©';
                
                const texts = translations[currentLang];
                document.querySelectorAll('[data-key]').forEach(el => {
                    const key = el.getAttribute('data-key');
                    if(texts[key]) el.innerText = texts[key];
                });
                document.getElementById('robuxAmount').placeholder = texts.ph_amount;
                
                updateStockStatus(); 
                calculatePrice();
                wrapper.classList.remove('fading');
            }, 300);
        }

        function calculatePrice() {
            const amount = document.getElementById('robuxAmount').value;
            const loc = document.getElementById('location').value;
            const display = document.getElementById('finalPrice');
            const billDetails = document.getElementById('billDetails');
            
            checkAllValid();

            if (!amount || amount <= 0) {
                display.innerText = loc === 'egypt' ? "0 EGP" : "0.00 $";
                billDetails.style.display = 'none';
                return;
            }

            if (loc === 'egypt') {
                let price = (amount / 1000) * EGP_PER_1000;
                let curr = currentLang === 'en' ? " EGP" : " Ø¬.Ù…";
                display.innerText = Math.ceil(price) + curr;
                billDetails.style.display = 'none';
            } else {
                let base = (amount / 1000) * USD_PER_1000;
                let total = (base + 0.30) / 0.95;
                let fees = total - base;
                let curr = currentLang === 'en' ? " $" : " Ø¯ÙˆÙ„Ø§Ø±";
                
                billDetails.style.display = 'block'; 
                document.getElementById('subtotalVal').innerText = base.toFixed(2) + curr;
                document.getElementById('feesVal').innerText = "+ " + fees.toFixed(2) + curr;
                display.innerText = total.toFixed(2) + curr;
            }
        }

        function submitOrder(e) {
            e.preventDefault();
            if(!isRobuxAvailable) return alert(translations[currentLang].alert_stock);

            const orderNum = Math.floor(Math.random() * 9000) + 1000;
            const orderID = `ORDER-${orderNum}`;

            document.getElementById('orderInputSection').style.display = 'none';
            document.getElementById('orderStatusSection').style.display = 'block';

            document.getElementById('displayOrderId').innerText = `#${orderID}`;
            document.getElementById('displayDiscord').innerText = document.getElementById('discordName').value;
            document.getElementById('displayRoblox').innerText = document.getElementById('robloxName').value;
            document.getElementById('displayPrice').innerText = document.getElementById('finalPrice').innerText;
        }

        updateStockStatus();
    </script>
</body>
</html>